本章节将对介绍性能优化的度量角度、度量方式与衡量标准，通过学习本章节，你将了解到：
- 从哪些维度去量化性能？
- 如何得到量化数据？
- 性能量化数据的标准线是什么？

下面，开始我们的性能量化之路。

# 量化角度
对性能进行量化需有对应的切入点，称为量化角度。

人们通常理解的性能量化角度是这个页面的打开速度是否足够“快”，“快”的页面性能更好，相反“慢”的页面性能有待提升。

那么，“快”这个角度是不是科学的量化的角度呢？先让我们来看一个场景：
> “这个页面的性能我已经测过了一遍了，在X.XX秒内就完成了页面加载。”
这样的概述的量化角度并没有错，但明显犯了几个错误：
- 量化的样本量过少
- 量化的环境过于单一
- 量化的维度过于单一

## 样本量
“一次测试”造成了以偏概全的视角，仅仅以一次测试结果为样本，而忽略了可能加载时间更长的样本。

现实情况下的加载时间应该是样本量加载时间的结合，而集合的分布情况往往呈现正态分布状，类似下图：

[![saHrND.png](https://s3.ax1x.com/2021/01/14/saHrND.png)](https://imgchr.com/i/saHrND)

图中的横轴是页面的加载时间，柱形的高度反映了处于对应区间的用户数量。如图所示，大多数的用户的页面在一到两秒内加载完成，但依然有很多用户等待了更长的时间。

## 采样环境
仅看单一环境下的采样结果必然容易忽略其他场景，而场景本身是多种条件的组合，采样的结果也就千差万别。

采样环境中至少包括了下述几项：
- 设备机型
- 设备操作系统平台
- 设备操作系统版本
- 网络条件
- 客户端版本号
- React Native Bundle版本号

其中任一组合后的采样环境，都会出现不同的采样结果，所以必须在量化角度中考虑进去。

## 量化指标
页面加载的快慢体验是不能够只用一个时间点指标来度量的。在页面加载的过程中有多个时间点能够让用户感受到“快”，如果我们只关注其中的一个，可能会忽略其他时间点带给用户的糟糕体验。

比如，一个页面的加载速度非常理想，非常“快”的将内容呈现给了用户，而之后需要加载一个Size非常大的JavaScript文件，并花费了几秒钟用来解析、执行。直到该JavaScript文件运行前，页面的内容都将不能与用户交互。这样的页面在用户面前时，加载速度的“快”变得毫无意义。

所以，使用一个指标去度量是远远不够的，指标的关注点应该映射到能够影响用户感知的各个时间点上。

用户感知的对应量化指标可以具体分为如下几个时间点：
- FP（First Paint）首次绘制
- FCP（First Contentful Paint）首次内容绘制
- FMP(First Meaningful Paint) 首次有效绘制
- TTI (Time to Interactive) 可交互时间
图示对应关系如下：

[![sdeYwV.png](https://s3.ax1x.com/2021/01/14/sdeYwV.png)](https://imgchr.com/i/sdeYwV)

- 首次绘制（FP）和首次内容绘制（FCP）：这两个指标项作为页面内容开始被绘制的时间点，两者的差别在于 FP 的时机在页面出现任何一个像素点时，而 FCP 的时机在DOM中出现内容。

- 首次有效绘制（FMP）：这个指标主要作为页面绘制完主要内容的时间点，App中该指标项通常对应页面的呼吸态/骨架屏时机。

- 可交互时间（TTI）：该指标用于标记应用已进行视觉渲染并能可靠响应用户输入的时间点。